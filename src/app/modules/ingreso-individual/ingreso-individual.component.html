<nav
  class="navbar navbar-light bg-light navbar-expand-lg sticky-top navbar-shadow-box"
>
  <div class="container-md">
    <app-modal-resumen-ingreso-individual
      (cerrar)="cerrarModalResumenIngresoIndividual()"
      (exito)="abrirModalExito()"
      *ngIf="mostrarModalResumenIngresoIndividual"
    >
    </app-modal-resumen-ingreso-individual>
    <app-modal-exitoso
      (cerrar)="cerrarModalExito()"
      *ngIf="mostrarModalExito"
      [mensajeModal]="mensajeModalExito"
      [titulo]="tituloModalExito"
    >
    </app-modal-exitoso>

    <a class="navbar-brand" href="home">
      <img
        alt="User Icon"
        class="d-inline-block align-text-top user-logo"
        height="40"
        src="../../../assets/image/Logo.svg"
        width="100"
      />
    </a>
    <button
      class="navbar-toggler"
      data-bs-target="#navbarCollapse"
      data-bs-toggle="collapse"
      type="button"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div
      class="collapse navbar-collapse justify-content-end"
      id="navbarCollapse"
    >
      <ul class="navbar-nav">
        <li class="d-none d-lg-block">
          <p-divider layout="vertical"></p-divider>
        </li>
        <li class="navbar-item d-lg-block d-none">
          <p class="nav-link text-end">Perfil</p>
          <ul class="navbar-nav">
            <li class="navbar-item">
              <p class="nav-link text-end">Hola, Juan Perez</p>
            </li>
          </ul>
        </li>
        <!-- Mostrar solo "Perfil" en pantallas pequeñas -->
        <li class="navbar-item">
          <a class="nav-link d-lg-none" href="#">Perfil Juan Perez</a>
        </li>
        <li
          class="navbar-item d-flex justify-content-center align-items-center"
        >
          <img
            alt="User Icon"
            class="user-icon"
            src="../../../assets/image/user.png"
          />
        </li>
      </ul>
    </div>
  </div>
</nav>
<div class="container-md">
  <div class="frame mt-3" id="frame_middletop">
    <div class="row">
      <div class="col-md-12">
        <h2 class="consultation-title">
          <img
            class=""
            height="16"
            src="../../../assets/image/logo-amarillo.jpg"
          />
          Ingreso Individual
        </h2>

        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            @for (crumb of breadcrumbs; track crumb.text) {
              <li class="breadcrumb-item" [class.active]="$last">
                <a *ngIf="!$last" [routerLink]="crumb.link">{{ crumb.text }}</a>
                <span *ngIf="$last">{{ crumb.text }}</span>
              </li>
            }
          </ol>
        </nav>
      </div>
    </div>
  </div>

  <form [formGroup]="ingresoIndividualForm" class="mt-4">
    <div class="grid-container gap-3">
      <div class="grid-item my-3">
        <div class="card flex flex-wrap gap-3 p-fluid border-0">
          <div class="flex-auto">
          <span class="p-float-label">
            <p-calendar
              [iconDisplay]="'input'"
              [showIcon]="true"
              dateFormat="dd/mm/yy"
              id="fecha_ingreso"
              inputId="fecha_ingreso"
              formControlName="fechaIngreso"
            ></p-calendar>
            <label class="" for="fecha_ingreso">Fecha de ingreso</label>
          </span>
          </div>
        </div>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input
          appRutFormatter
          autocomplete="on"
          class="w-100 rounded"
          id="rut"
          pInputText
          type="text"
          formControlName="rut"
        />
        <label for="rut">Rut (12345678-9)</label>
      </span>
      </div>
      <div class="grid-item my-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Choose an option</mat-label>
          <mat-select [disabled]="false">
            <mat-option value="option1">Option 1</mat-option>
            <mat-option disabled value="option2">Option 2 (disabled)</mat-option>
            <mat-option value="option3">Option 3</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="grid-item my-3">
        <select
          (change)="onEmpresaChange($event.target)"
          class="form-select py-3 color-select"
          pInputText
        >
          <option [value]="undefined" disabled selected>Empresa</option>
          @for (empresa of selectorEmpresas; track empresa.value) {
            <option [value]="empresa.value">{{ empresa.label }}</option>
          }
        </select>
      </div>

      <div class="grid-item my-3">
        <select
          (change)="onAgencyChange()"
          class="form-select py-3 color-select"
          formControlName="agenciaId"
        >
          <option disabled selected>Agencia</option>
          @for (agency of selectorAgencies; track agency.id) {
            <option [value]="agency.id">{{ agency.nombre }}</option>
          }
        </select>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input
          class="w-100 rounded"
          id="dpc"
          pInputText
          placeholder="DPC"
          type="text"
          formControlName="agenciaDpc"
        />
        <label for="dpc">DPC</label>
      </span>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input
          class="w-100 rounded"
          id="nemonico"
          pInputText
          placeholder="Nemónico"
          type="text"
          formControlName="agenciaMnemonic"
        />
        <label for="nemonico">Nemónico</label>
      </span>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input class="w-100 rounded" formControlName="inventario" id="inventario" pInputText type="Number"/>
        <label for="inventario">N° Inventario</label>
      </span>
      </div>
      <div class="grid-item my-3">
        <select (change)="onTypeChange()" class="form-select py-3 color-select" formControlName="tipo">
          <option disabled selected>Tipo de Equipo</option>

          @for (type of equipmentTypes; track type.value) {
            <option [ngValue]="type.value">{{ type.label }}</option>
          }
        </select>
      </div>

      <div class="grid-item my-3">
        <ng-container *ngIf="isEquipmentWithNoOptions(selectedType); else notSpecialEquipment">
          <select class="form-select py-3 color-select" disabled>
            <option value="N/A">N/A</option>
          </select>
        </ng-container>
        <ng-template #notSpecialEquipment>
          <select (change)="onSOChange()" class="form-select py-3 color-select">
            <option disabled value="">Sistema Operativo</option>

            @for (so of selectorSistemasOperativos; track so.so) {
              <option [ngValue]="so.so">{{ so.so }}</option>
            }
          </select>
        </ng-template>
      </div>


      <div class="grid-item my-3">
        <select
          [disabled]="selectorVersionesFiltradas.length === 0"
          [ngClass]="{ 'disabled-select': selectorVersionesFiltradas.length === 0 }"
          class="form-select py-3 color-select"
        >
          <option disabled value="">Versión</option>
          @for (version of selectorVersionesFiltradas; track version) {
            <option [ngValue]="version">{{ version }}</option>
          }
        </select>
      </div>
      <div class="grid-item my-3">
        <select class="form-select py-3 color-select" formControlName="uso">
          <option disabled selected value="">Uso</option>
          <option>Administrativo</option>
          <option>Caja</option>
        </select>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input
          autocomplete="on"
          class="w-100 rounded"
          id="marca"
          pInputText
          type="text"
          formControlName="marca"
        />
        <label for="marca">Marca</label>
      </span>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input
          autocomplete="on"
          class="w-100 rounded"
          id="modelo"
          pInputText
          type="text"
          formControlName="modelo"
        />
        <label for="modelo">Modelo</label>
      </span>
      </div>
      <div class="grid-item my-3">
        <span class="p-float-label">
          <input
            [value]="onMacInput()"
            class="w-100 rounded"
            formControlName="mac"
            id="mac"
            pInputText
            type="text"
          />
          <label for="mac">MAC (XX:XX:XX:XX:XX:XX)</label>
        </span>
        <!--        <div *ngIf="isValidMAC === false" class="text-danger">-->
        <!--          Dirección MAC no válida-->
        <!--        </div>-->
      </div>
      <div class="grid-item my-3">
        <span class="p-float-label">
          <input
            (keyup)="limitAndValidateIP()"
            class="w-100 rounded"
            formControlName="ip"
            id="ip"
            pInputText
            type="text"
          />

          <label for="ip">IP (IPV4 o IPv6)</label>
        </span>
        <!--        <div *ngIf="isValidIP === false" class="text-danger"> &lt;!&ndash; TODO: implementar mat-error &ndash;&gt;-->
        <!--          Dirección IP no válida-->
        <!--        </div>-->
      </div>
      <div class="grid-item my-3">
        <span class="p-float-label">
          <input class="w-100 rounded" formControlName="nombre" id="maquina" pInputText type="text"/>
          <label for="maquina">Nombre Máquina </label>
        </span>
      </div>
      <div class="grid-item my-3">
        <span class="p-float-label">
          <input
            class="w-100 rounded"
            formControlName="procesador"
            id="procesador"
            pInputText
            type="text"
          />
          <label for="procesador">Procesador</label>
        </span>
      </div>
      <div class="grid-item my-3">
        <div class="p-float-label position-relative">
          <input
            class="w-100 rounded"
            formControlName="ramGb"
            id="ram"
            pInputText
            type="text"/>
          <label for="ram">RAM</label>
          <div *ngIf="!isEquipmentWithNoOptions(selectedType)"
               class="position-absolute"
               style="top: 0; right: 10px; height: 100%; display: flex; align-items: center; pointer-events: none;">
            GB
          </div>
        </div>
      </div>

      <div class="grid-item my-3">
        <select class="form-select py-3 color-select w-100 rounded " formControlName="disco">
          @if (!isEquipmentWithNoOptions(selectedType)) {
            <option disabled>SSD/HDD</option>
            <option value="SSD">SSD</option>
            <option value="HDD">HDD</option>
          }
        </select>
      </div>

      <div class="grid-item my-3">
        <!-- TODO: revisar appLimitInput, a que corresponde -->
        <span class="p-float-label">

          <!-- TODO: usar valueChanges -->
          <input
            appLimitInput
            class="w-100 rounded"
            formControlName="ddllTbk"
            id="ddlTbk"
            pInputText
            type="text"
          />
          <label for="ddlTbk">DDL/TBK (XXX-XXX-XXX)</label>
        </span>
        <!--        <div *ngIf="isValidDDLTBK === false" class="text-danger">-->
        <!--          Formato DDL/TBK no válido-->
        <!--        </div>-->
      </div>
      <div class="grid-item my-3">
        <span class="p-float-label">
          <input class="w-100 rounded" formControlName="serie" id="serie" pInputText type="text"/>
          <label for="serie">Número de Serie </label>
        </span>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input
          autocomplete="on"
          class="w-100 rounded"
          id="encargado"
          pInputText
          type="text"
          formControlName="encargadoAgencia"
        />
        <label for="encargado">Encargado Agencia</label>
      </span>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input class="w-100 rounded" formControlName="ubicacion" id="ubicacion" pInputText type="text"/>
        <label for="ubicacion">Ubicación</label>
      </span>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input class="w-100 rounded" id="garantia" pInputText type="Number" formControlName="garantiaMeses"/>
        <label for="garantia">Garantía</label>
      </span>
      </div>
      <div class="grid-item my-3">
      <span class="p-float-label">
        <input
          autocomplete="on"
          class="w-100 rounded"
          id="orden_compra"
          pInputText
          type="text"
        />
        <label for="orden_compra">Orden de compra</label>
      </span>
      </div>
    </div>
  </form>

  <div class="row">
    <div class="col">
      <hr/>
    </div>
  </div>

  <div class="row mt-3 mb-5">
    <div class="col-12">
      <div class="d-flex justify-content-between">
        <button
          class="back-button px-5 py-2"
          label="Volver"
          pButton
          routerLink="/home"
          type="button"
        ></button>

        <button
          (click)="abrirModalResumenIngresoIndividual()"
          class="search-button px-5 py-2"
          label="Ingresar"
          [disabled]="!ingresoIndividualForm.valid"
          pButton
          type="button"
        ></button>
      </div>
    </div>
  </div>
</div>
